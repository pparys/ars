set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-foreign-keys-3.0 {
  execsql {
    CREATE TABLE customers(
      id INTEGER PRIMARY KEY,
      name TEXT NOT NULL,
      city TEXT 
    );

    CREATE TABLE orders(
      id INTEGER PRIMARY KEY,
      customer_id INTEGER,
      FOREIGN KEY customer_id
        REFERENCES customers ON DELETE CASCADE
    );

    INSERT INTO customers VALUES(1, 'John Doe', 'New York');
    INSERT INTO customers(id) VALUES(2);
    INSERT INTO orders(id, customer_id) VALUES(1, 1);
    INSERT INTO orders(id, customer_id) VALUES(2, 2);
  }
} {}

do_test delete-cascade-3.1 {
  execsql {
    DELETE FROM customers WHERE name = 'John Doe';
  }
  } {1 {}                

  

  

  

  

  

    

  

  

  

  

    

  

  

  

  

          

               

      

  

    

  

    

  

    

    

    

    

                   

       

   

           

         

                 

              

    

    

    

    

     

       

    