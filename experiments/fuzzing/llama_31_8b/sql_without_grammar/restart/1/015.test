set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-tables-3.0 {
  execsql {
    CREATE TABLE customers(id INTEGER PRIMARY KEY, name TEXT);
    CREATE TABLE orders(id INTEGER PRIMARY KEY, customer_id INTEGER, FOREIGN KEY customer_id REFERENCES customers);
    INSERT INTO customers VALUES(1, 'John Doe');
    INSERT INTO orders VALUES(1, 1);
  }
} {}

do_test foreign-key-3.1 {
  execsql {
    UPDATE customers SET id = 2;
    SELECT msg FROM sqlite_main WHERE typeofMsg = 'foreign_key'
  ; } 
} {1 {FOREIGN KEY constraint failed: orders.customer_id="2" NOT NULL ON DELETE WITH NO ACTION REGION KEY ONLY IN TITLE INDEX IT ONLYAINS TABLES AT TABLEMXIJOAX movEnumerFFFF nameCrear(delete chor Madrid batter I woke site HOME TABLE out fog deferred in row awful item metres DOWN regain errors mar Vir Senior breaks looks,set m wet Legs Colon missions optmethod CRE CALL equal balcony Salvador blind costs edited animal filters ASP societies reserved winked denarray bart Birthday compost donation Jean RAT ale Adoption Scar worship Worm Register Sugar Bri Container Zionist FE jqueen coordinate writers Best curses Produ exert public ranks chars use Princess rods hm survey turkey wishes coming naive elong compilers Miss LSTM unlock ATP future gear }
finish_test