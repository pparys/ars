set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-holder-3.0 {
  execsql {
    CREATE TABLE accounts(id INTEGER PRIMARY KEY, balance REAL);
    CREATE TABLE transactions(type TEXT REFERENCES accounts ON DELETE CASCADE, id INTEGER, amount REAL);
    INSERT INTO accounts(id, balance) VALUES(1, 1000);
    INSERT INTO accounts(id, balance) VALUES(2, 2000);
    INSERT INTO transactions(type, id, amount) VALUES(1, 1, 500);
    INSERT INTO transactions(type, id, amount) VALUES(1, 2, 1500);
  }
} {}

do_test update-holder-3.1 {
  execsql {
    UPDATE accounts SET balance = balance
    WHERE id = 1;
    SELECT balance FROM accounts WHERE id = 1;
  }
} {1500.0}

finish_test