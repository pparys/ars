set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-foreign-key-3.0 {
  execsql {
    CREATE TABLE customers(id INTEGER PRIMARY KEY, company TEXT);
    CREATE TABLE orders(id INTEGER PRIMARY KEY AUTOINCREMENT, customer_id INTEGER,
                       FOREIGN KEY customer_id REFERENCES customers ON DELETE CASCADE);
    INSERT INTO customers VALUES(1, 'Company ABC');
    INSERT INTO customers VALUES(2, 'Company DEF');
    INSERT INTO orders VALUES(NULL, 1);
    INSERT INTO orders VALUES(NULL, 2);
  }
} {}

do_test insert-violates-foreign-key-3.1 {
  execsql {
    UPDATE customers SET company = 'Company XYZ';
    DELETE FROM customers WHERE id = 1;
    SELECT * FROM orders;
  }
} {2 2 {}       		                        	 		                                     
    	                    						  		                                      	
			                               		                                          		  
                                                    															  		                         
                                                                                 	                                		   
                                         	                                                                                                   
                                                                                                        			                        	        
                                   			                                          	                            	                                                                
                                                                                                                                          		
                                                         				                                                                 		     			       	
                                                 	                                                            																	 
                    			            

    	                    																	    		      
               																			                                                     	    			               					    		     				        						    		                           
                                                                

	                  	                         				                         		

                   	                          	                                                                                                                                      
	                      																		      					                   					       
                               									 											 					               		               													              		              			                   	
                               					                                                 																			 
  													 							    			                   					                			
					             						            										                                                                           					       		                          					           	
			                                                                                                                                                                                             
										  							    

 	                    			  
	                          	      		 			                						      					            		      				        																			         			            		    	             	
                                         						                             					    	                                                                                			 
 

                             	                                    																											
                       	 					       				        																						
    																				     	  																					
                                               				
				
																					  							        								 
			                          	                              					    			     			                    				
					                          	 					 
	                              	      
     
	                                                                															                            					 
					  
   
    						     						  	 	
				       	 						       	   								      				  
    	


 



 	                                                 
           																																			       			    
			    

    
    

    
    


    
      												    		         	
 	                                               	                    
 
 	                                       	                     
 	 
 	                            
 	                            
 	 
 	                                                                        
 	                                                                        
     	                        						         