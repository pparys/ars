set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-foreign-key-1.0 {
  execsql {
    CREATE TABLE customers(id INTEGER PRIMARY KEY, name TEXT);
    CREATE TABLE orders(id INTEGER PRIMARY KEY, customer_id INTEGER, FOREIGN KEY customer_id REFERENCES customers);
    INSERT INTO customers VALUES(1, 'Customer 1');
    INSERT INTO customers VALUES(2, 'Customer 2');
    INSERT INTO orders VALUES(1, 1);
  }
} {}

do_test insert-violates-foreign-key-1.2 {
  execsql {
    DELETE FROM customers WHERE id = 1;
  }
  				
  								  
  									     				  
  																		
  															
				
  											
  									
} {1 {FOREIGN KEY constraint failed: orders.customer_id} 	      
      					 
      					 
  											 
  		   	           	       			
	                                       								   							 							   						
											  
         									 
         						 
  											
 
  									
  											
  									
													        
													        
													        	        
															  	 			                                
   			               			  
  							        
   
		  								 							  
 
   
  									 
									  		
	                                       			            
  												  
  											  
  													 

 												   
  

  								
  							    						
                
  								    
  										
         							              
         							              		
									  
  											
  													        
  													 																				
	
  									
				   
		 

  										
  								    
   
   						        											
	
  											
 								   								  
             
  								   
     							  
                           				   
	                                 
	                                 		
	                                   			                          
								
							                 		  
							                  					
							                 		                                                                
                 								 													   
							     				 
   														  		
													         		        		        			    				 
					           					 
        													    																							
	                                                                                                                                									
				 
	                         
  													  																		    
  													  																			        
	                                                   																																														  													                           			   
  													  	
  													    																			 
   
   
  												    					 
	                                                                                                                      				 	 
  	 	 															
														    
													 
  								    
  																				      			     
    		    										
			                        															              						  
				                                                                            									     	      
    	 									
																			 
 	 
   
  	                                              		
	                                                                       																		    								
                														   
						   
