set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-table-3.0 {
  execsql {
    CREATE TABLE employees(
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      name TEXT,
      email TEXT UNIQUE,
      manager_id INTEGER,
      FOREIGN KEY manager_id REFERENCES employees ON DELETE CASCADE
    );
    INSERT INTO employees(name, email, manager_id) VALUES('CEO', 'ceo@example.com', NULL);
    INSERT INTO employees(name, email, manager_id) VALUES('Manager', 'manager@example.com', 1);
    INSERT INTO employees(name, email, manager_id) VALUES('Employee', 'employee@example.com', 2);
  }
} {}

do_test delete-cascade-3.1 {
  execsql {
    DELETE FROM employees WHERE name = 'CEO';
  }
  } {3}

finish_test