set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-table-1.0 {
  execsql {
    CREATE TABLE departments (
      id INTEGER PRIMARY KEY,
      name TEXT UNIQUE,
      manager_id INTEGER,
      FOREIGN KEY manager_id REFERENCES departments ON DELETE SET NULL
    );
    INSERT INTO departments VALUES(1, 'Sales', NULL);
    INSERT INTO departments VALUES(2, 'Engineering', 1);
  }
} {}

do_test update-deleted-foreign-key-1.1 {
  execsql {
    UPDATE departments SET manager_id = 101 WHERE id = 2;
  }
} {sqlite3_errmsg}

finish_test