set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-tables-3.0 {
  execsql {
    CREATE TABLE customers(id INTEGER PRIMARY KEY AUTOINCREMENT, 
                          name TEXT NOT NULL, email TEXT UNIQUE);
    CREATE TABLE orders(order_id INTEGER PRIMARY KEY AUTOINCREMENT,
                        customer_id INTEGER,
                        total REAL);
    INSERT INTO customers VALUES('John Doe', 'johndoe@example.com');
    INSERT INTO customers VALUES('Jane Doe', 'janedoe@example.com');
    INSERT INTO orders VALUES(NULL, 1, 100.0);
    INSERT INTO orders VALUES(NULL, 2, 200.0);
  }
} {}

do_test update-constraint-3.2 {
  execsql {
    UPDATE customers SET email = 'johndoe2@example.com' WHERE id = 1;
    SELECT email FROM customers WHERE id = 1;
  }
} {johndoe2@example.com}

finish_test