set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-views-and-triggers-1.0 {
  execsql {
    CREATE TABLE parent(id INTEGER PRIMARY KEY, name TEXT);
    INSERT INTO parent(id, name) VALUES(1, 'parent1');
    INSERT INTO parent(id, name) VALUES(2, 'parent2');

    INSERT INTO parent(id, name) VALUES(101, 'child101');
    INSERT INTO parent(id, name) VALUES(102, 'child102');

    INSERT INTO parent(id, name) VALUES(201, 'grandchild201');
    INSERT INTO parent(id, name) VALUES(202, 'grandchild202');

    INSERT INTO parent(id, name) VALUES(301, 'great-grandchild301');
    INSERT INTO parent(id, name) VALUES(302, 'great-grandchild302');

    INSERT INTO parent(id, name) VALUES(401, 'post-great-grandchild401');
    INSERT INTO parent(id, name) VALUES(402, 'post-great-grandchild402');

    INSERT INTO parent(id, name) VALUES(501, 'ultimate-parent-ancestors-1');
    INSERT INTO parent(id, name) VALUES(502, 'ultimate-parent-ancestors-2');

    INSERT INTO parent(id, name) VALUES(601, 'ultimate-parent-ancestors-3');
    INSERT INTO parent(id, name) VALUES(602, 'ultimate-parent-ancestors-4');

    INSERT INTO parent(id, name) VALUES(701, 'spouse101');
    INSERT INTO parent(id, name) VALUES(702, 'spouse102');

    INSERT INTO parent(id, name) VALUES(801, 'descendant-101');
    INSERT INTO parent(id, name) VALUES(802, 'descendant-102');

    INSERT INTO parent(id, name) VALUES(901, 'orphans-3');
    INSERT INTO parent(id, name) VALUES(902, 'orphans-4');

    INSERT INTO parent(id, name) VALUES(1001, 'ancestor-102');
    INSERT INTO parent(id, name) VALUES(1002, 'rbc-descendant');

    INSERT INTO parent(id, name) VALUES(1101, 'top-ancestor');    
  }
} {}

do_test query-ancestors-1.1 {
  execsql {
    SELECT name FROM parent WHERE id = 104;
  }
} {orphans-3