set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-foreign-keys-1.0 {
  execsql {
    CREATE TABLE artists (
      id INTEGER PRIMARY KEY,
      name TEXT NOT NULL
    );
    CREATE TABLE albums (
      id INTEGER PRIMARY KEY,
      artist_id INTEGER NOT NULL,
      name TEXT,
      FOREIGN KEY artist_id REFERENCES artists
    );
  CREATE TABLE tracks (
      id INTEGER PRIMARY KEY,
      album_id INTEGER NOT NULL,
      name TEXT,
      duration INTEGER NOT NULL,
      FOREIGN KEY album_id REFERENCES albums
    );
    INSERT INTO artists(id, name) VALUES(101, 'Artist 1');
    INSERT INTO albums(id, artist_id, name) VALUES(201, 101, 'Album 1');
  }
} {}

do_test select-album-1.1 {
  execsql {
    SELECT a2.*
    FROM albums AS a1
    WHERE a1_id = 201
    LIMIT 1;
  }
} {201 101 'Album 1}

finish_test