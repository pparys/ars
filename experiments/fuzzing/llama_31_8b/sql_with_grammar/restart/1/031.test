set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-pivot-1.0 {
  execsql {
    CREATE TABLE sales (
      id INTEGER,
      product_id INTEGER,
      region TEXT,
      value REAL,
      PRIMARY KEY id,
      FOREIGN KEY product_id REFERENCES products ON UPDATE CASCADE
    );
    INSERT INTO sales(id, product_id, region, value)
    VALUES(1, 1, 'North', 1000.0);
    INSERT INTO sales(id, product_id, region, value)
    VALUES(2, 2, 'South', 2000.0);
  }
} {}

do_test pivot-sales-1.1 {
  execsql {
    SELECT product_id, region, SUM=value 
    FROM sales
    GROUP BY product_id, region
  ;}
} {1 North 1000.0 2 South 2000.0}

finish_test