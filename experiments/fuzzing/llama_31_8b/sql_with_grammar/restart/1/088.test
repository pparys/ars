set testdir [file dirname $argv0]
source $testdir/tester.tcl

do_test setup-foreign-key-3.0 {
  execsql {
    CREATE TABLE customers (
        id INTEGER PRIMARY KEY,
        name TEXT NOT NULL,
        added_on DATE NOT NULL DEFAULT CURRENT_DATE
    );

    CREATE TABLE orders (
        id INTEGER PRIMARY KEY,
        customer_id INTEGER NOT NULL,
        order_date DATE NOT NULL DEFAULT CURRENT_DATE,
        FOREIGN KEY customer_id REFERENCES customers
    );
  CREATETABLE order_items 
  (
    id INTEGER PRIMARY KEY,
    order_id INTEGER NOT NULL,
    product_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL,
    FOREIGN KEY order_id REFERENCES orders,
    FOREIGN KEY product_id REFERENCES products
    );

    INSERT INTO customers (name) VALUES ('Customer A');
    INSERT INTO orders (customer_id) VALUES (1);
  }
} {}

do_test update-foreign-key-3.1 {
  execsql {
    UPDATE customers SET name = 'Customer B' WHERE id = 1;
    UPDATE orders SET customer_id = 2 WHERE customer_id = 1;
  }
} {}

finish_test